<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TESDA: ACLC - Admin Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-blue: #1e3c72;
            --secondary-blue: #2a5298;
            --accent-blue: #4fc3f7;
            --light-blue: #f0f5ff;
            --dark-gray: #333;
            --medium-gray: #666;
            --light-gray: #f8f9fa;
            --white: #ffffff;
            --success: #2e7d32;
            --warning: #ff9800;
            --danger: #e53935;
            --sidebar-width: 250px;
        }

        body {
            background: #f5f7fa;
            min-height: 100vh;
        }

        /* Top Header */
        .dashboard-header {
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            text-decoration: none;
            color: var(--dark-gray);
        }

        .logo-icon {
            font-size: 28px;
            color: var(--primary-blue);
        }

        .logo-text h2 {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary-blue);
        }

        .logo-text span {
            font-size: 12px;
            color: var(--medium-gray);
        }

        .admin-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .admin-details {
            text-align: right;
        }

        .admin-details h3 {
            color: var(--primary-blue);
            font-size: 16px;
            margin-bottom: 3px;
        }

        .admin-details p {
            color: var(--medium-gray);
            font-size: 13px;
        }

        .admin-avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }

        .logout-btn {
            background: var(--light-blue);
            color: var(--primary-blue);
            border: 1px solid var(--primary-blue);
            padding: 8px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: var(--primary-blue);
            color: white;
        }

        /* Main Layout */
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
            display: grid;
            grid-template-columns: var(--sidebar-width) 1fr;
            gap: 30px;
        }

        /* Sidebar */
        .sidebar {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            height: fit-content;
            position: sticky;
            top: 100px;
        }

        .sidebar h3 {
            color: var(--primary-blue);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-blue);
            font-size: 18px;
        }

        .sidebar-nav {
            list-style: none;
        }

        .sidebar-nav li {
            margin-bottom: 10px;
        }

        .sidebar-nav a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            color: var(--dark-gray);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 500;
        }

        .sidebar-nav a:hover {
            background: var(--light-blue);
            color: var(--primary-blue);
        }

        .sidebar-nav a.active {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            color: white;
        }

        .notification-badge {
            background: var(--danger);
            color: white;
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
            margin-left: auto;
        }

        /* Main Content */
        .main-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            min-height: 600px;
        }

        .content-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-blue);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .content-header h1 {
            color: var(--primary-blue);
            font-size: 28px;
            margin-bottom: 10px;
        }

        .content-header p {
            color: var(--medium-gray);
            font-size: 16px;
        }

        /* Statistics Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 2px solid var(--light-blue);
            text-align: center;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 15px;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-blue);
        }

        .stat-label {
            color: var(--medium-gray);
            font-size: 14px;
            font-weight: 500;
        }

        /* Applicants Table */
        .table-container {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-top: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: var(--light-blue);
        }

        th {
            padding: 15px;
            text-align: left;
            color: var(--primary-blue);
            font-weight: 600;
            border-bottom: 2px solid var(--primary-blue);
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            color: var(--dark-gray);
        }

        tr:hover {
            background: #f9f9f9;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            text-align: center;
            min-width: 100px;
        }

        .badge-pending { background: #fff3e0; color: #ef6c00; }
        .badge-under-review { background: #e3f2fd; color: var(--primary-blue); }
        .badge-approved { background: #e8f5e9; color: var(--success); }
        .badge-rejected { background: #ffebee; color: var(--danger); }
        .badge-not-started { background: #f5f5f5; color: var(--medium-gray); }
        .badge-documents-completed { background: #e3f2fd; color: #2196f3; }
        .badge-exam-completed { background: #e8f5e9; color: #4caf50; }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-icon {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn-view { background: #e3f2fd; color: #1976d2; }
        .btn-approve { background: #e8f5e9; color: #2e7d32; }
        .btn-reject { background: #ffebee; color: #c62828; }
        .btn-edit { background: #fff3e0; color: #ef6c00; }

        .btn-icon:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        /* Search and Filter */
        .filter-container {
            background: var(--light-blue);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .filter-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark-gray);
            font-weight: 500;
            font-size: 14px;
        }

        .filter-control {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e1e5ee;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .filter-control:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .btn-filter {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            align-self: flex-end;
            transition: all 0.3s;
        }

        .btn-filter:hover {
            background: var(--secondary-blue);
            transform: translateY(-2px);
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            display: none;
        }

        .modal {
            background: white;
            border-radius: 15px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            color: white;
            padding: 25px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 22px;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            padding: 30px;
        }

        /* Applicant Details */
        .applicant-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .detail-section {
            background: var(--light-blue);
            padding: 20px;
            border-radius: 10px;
        }

        .detail-section h4 {
            color: var(--primary-blue);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid white;
        }

        .detail-row {
            display: grid;
            grid-template-columns: 120px 1fr;
            gap: 15px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.5);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 600;
            color: var(--dark-gray);
        }

        .detail-value {
            color: var(--medium-gray);
        }

        /* Documents View */
        .documents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .document-item {
            background: white;
            border: 2px solid #e1e5ee;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s;
        }

        .document-item.verified {
            border-color: var(--success);
            background: rgba(46, 125, 50, 0.05);
        }

        .document-item.required {
            border-color: var(--warning);
        }

        .document-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .document-name {
            font-weight: 600;
            color: var(--dark-gray);
        }

        .document-actions {
            display: flex;
            gap: 5px;
        }

        .btn-verify {
            background: var(--success);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-verify:hover {
            background: #2e7d32;
        }

        /* Exam Results */
        .exam-results {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .exam-score {
            font-size: 36px;
            font-weight: bold;
            color: var(--primary-blue);
            text-align: center;
            margin: 20px 0;
        }

        .exam-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        /* Program Management */
        .programs-management {
            margin-top: 30px;
        }

        .program-card {
            background: white;
            border: 2px solid #e1e5ee;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .program-card:hover {
            border-color: var(--primary-blue);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .program-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .program-header h3 {
            color: var(--primary-blue);
            font-size: 20px;
        }

        .program-actions {
            display: flex;
            gap: 10px;
        }

        .program-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .info-item {
            background: var(--light-blue);
            padding: 10px 15px;
            border-radius: 6px;
        }

        .info-label {
            font-size: 12px;
            color: var(--medium-gray);
            margin-bottom: 5px;
        }

        .info-value {
            font-weight: 600;
            color: var(--dark-gray);
        }

        /* Reports Section */
        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .report-card {
            background: white;
            border: 2px solid #e1e5ee;
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .report-card:hover {
            border-color: var(--primary-blue);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .report-icon {
            font-size: 40px;
            margin-bottom: 15px;
            color: var(--primary-blue);
        }

        .report-card h4 {
            color: var(--primary-blue);
            margin-bottom: 10px;
        }

        .report-card p {
            color: var(--medium-gray);
            font-size: 14px;
        }

        /* Export Buttons */
        .export-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .btn-export {
            background: white;
            color: var(--primary-blue);
            border: 2px solid var(--primary-blue);
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .btn-export:hover {
            background: var(--primary-blue);
            color: white;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .dashboard-container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
                top: auto;
            }
            
            .applicant-details {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .admin-info {
                flex-direction: column;
                gap: 15px;
            }
            
            .admin-details {
                text-align: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-row {
                flex-direction: column;
            }
            
            .action-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .btn-icon {
                width: 100%;
            }
            
            .table-container {
                overflow-x: auto;
            }
            
            table {
                min-width: 800px;
            }
        }

        /* Loading State */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--light-blue);
            border-top-color: var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--medium-gray);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        /* Search Bar */
        .search-bar {
            position: relative;
            max-width: 300px;
        }

        .search-input {
            width: 100%;
            padding: 10px 15px 10px 40px;
            border: 2px solid #e1e5ee;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(42, 82, 152, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--medium-gray);
        }
    </style>
</head>
<body>
    <!-- Admin Header -->
    <header class="dashboard-header">
        <div class="header-container">
            <a href="index.html" class="logo">
                <div class="logo-icon">üëë</div>
                <div class="logo-text">
                    <h2>TESDA: ACLC</h2>
                    <span>Admin Dashboard</span>
                </div>
            </a>
            
            <div class="admin-info">
                <div class="admin-details">
                    <h3 id="adminName">Administrator</h3>
                    <p id="adminRole">System Administrator</p>
                </div>
                <div class="admin-avatar" id="adminAvatar">A</div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </div>
    </header>

    <!-- Main Dashboard Content -->
    <div class="dashboard-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <h3>Admin Navigation</h3>
            <ul class="sidebar-nav">
                <li>
                    <a href="#" class="active" onclick="showSection('overview')">
                        <span>üìä</span> Dashboard Overview
                    </a>
                </li>
                <li>
                    <a href="#" onclick="showSection('applicants')" id="applicantsLink">
                        <span>üë•</span> Manage Applicants
                        <span class="notification-badge" id="applicantsNotification">0</span>
                    </a>
                </li>
                <li>
                    <a href="#" onclick="showSection('documents')" id="documentsLink">
                        <span>üìÑ</span> Review Documents
                        <span class="notification-badge" id="documentsNotification">0</span>
                    </a>
                </li>
                <li>
                    <a href="#" onclick="showSection('exam')">
                        <span>üíØ</span> Exam Results
                    </a>
                </li>
                <li>
                    <a href="#" onclick="showSection('programs')">
                        <span>üéì</span> Program Management
                    </a>
                </li>
                <li>
                    <a href="#" onclick="showSection('reports')">
                        <span>üìà</span> Reports & Analytics
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Dashboard Overview -->
            <div id="overviewSection" class="content-section">
                <div class="content-header">
                    <div>
                        <h1>Admin Dashboard</h1>
                        <p>Manage scholarship applications and system settings</p>
                    </div>
                    <div class="search-bar">
                        <span class="search-icon">üîç</span>
                        <input type="text" class="search-input" placeholder="Search applications..." id="globalSearch">
                    </div>
                </div>

                <!-- Statistics -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üìù</div>
                        <div class="stat-number" id="totalApplications">0</div>
                        <div class="stat-label">Total Applications</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è≥</div>
                        <div class="stat-number" id="pendingReview">0</div>
                        <div class="stat-label">Pending Review</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-number" id="approved">0</div>
                        <div class="stat-label">Approved</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚ùå</div>
                        <div class="stat-number" id="rejected">0</div>
                        <div class="stat-label">Rejected</div>
                    </div>
                </div>

                <!-- Recent Applications -->
                <div class="content-header" style="margin-top: 40px;">
                    <h2>Recent Applications</h2>
                </div>
                
                <div class="table-container">
                    <table id="recentApplicationsTable">
                        <thead>
                            <tr>
                                <th>Application ID</th>
                                <th>Student Name</th>
                                <th>Program</th>
                                <th>Date Applied</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="recentApplicationsBody">
                            <!-- Applications will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Manage Applicants -->
            <div id="applicantsSection" class="content-section" style="display: none;">
                <div class="content-header">
                    <div>
                        <h1>Manage Applicants</h1>
                        <p>Review and process scholarship applications</p>
                    </div>
                    <div class="search-bar">
                        <span class="search-icon">üîç</span>
                        <input type="text" class="search-input" placeholder="Search applicants..." id="applicantSearch">
                    </div>
                </div>

                <!-- Filters -->
                <div class="filter-container">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label>Program</label>
                            <select class="filter-control" id="filterProgram">
                                <option value="">All Programs</option>
                                <option value="wadt">Web Development (WADT)</option>
                                <option value="hrt">Hotel & Restaurant (HRT)</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Status</label>
                            <select class="filter-control" id="filterStatus">
                                <option value="">All Status</option>
                                <option value="pending">Pending</option>
                                <option value="under-review">Under Review</option>
                                <option value="approved">Approved</option>
                                <option value="rejected">Rejected</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Date Range</label>
                            <input type="date" class="filter-control" id="filterDateFrom">
                        </div>
                        <div class="filter-group">
                            <label>To</label>
                            <input type="date" class="filter-control" id="filterDateTo">
                        </div>
                        <button class="btn-filter" onclick="filterApplicants()">Apply Filters</button>
                    </div>
                </div>

                <!-- Applicants Table -->
                <div class="table-container">
                    <table id="applicantsTable">
                        <thead>
                            <tr>
                                <th>Application ID</th>
                                <th>Student Name</th>
                                <th>Email</th>
                                <th>Program</th>
                                <th>Date Applied</th>
                                <th>Documents</th>
                                <th>Exam Score</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="applicantsTableBody">
                            <!-- Applicants will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Review Documents -->
            <div id="documentsSection" class="content-section" style="display: none;">
                <div class="content-header">
                    <h1>Review Documents</h1>
                    <p>Verify and validate applicant documents</p>
                </div>

                <!-- Documents Table -->
                <div class="table-container">
                    <table id="documentsTable">
                        <thead>
                            <tr>
                                <th>Student Name</th>
                                <th>Document Type</th>
                                <th>File Name</th>
                                <th>Upload Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="documentsTableBody">
                            <!-- Documents will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Exam Results -->
            <div id="examSection" class="content-section" style="display: none;">
                <div class="content-header">
                    <h1>Exam Results</h1>
                    <p>View and evaluate applicant exam scores</p>
                </div>

                <!-- Exam Results Table -->
                <div class="table-container">
                    <table id="examResultsTable">
                        <thead>
                            <tr>
                                <th>Student Name</th>
                                <th>Program</th>
                                <th>Exam Score</th>
                                <th>Result</th>
                                <th>Date Taken</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody id="examResultsBody">
                            <!-- Exam results will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <!-- Exam Statistics -->
                <div style="margin-top: 40px;">
                    <h3>Exam Statistics</h3>
                    <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));">
                        <div class="stat-card">
                            <div class="stat-number" id="totalExams">0</div>
                            <div class="stat-label">Total Exams Taken</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="passRate">0%</div>
                            <div class="stat-label">Pass Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="avgScore">0</div>
                            <div class="stat-label">Average Score</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="topScore">0</div>
                            <div class="stat-label">Top Score</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Program Management -->
            <div id="programsSection" class="content-section" style="display: none;">
                <div class="content-header">
                    <h1>Program Management</h1>
                    <p>Manage scholarship program information</p>
                </div>

                <!-- Programs List -->
                <div class="programs-management">
                    <div class="program-card">
                        <div class="program-header">
                            <h3>Web Application Development Training (WADT)</h3>
                            <div class="program-actions">
                                <button class="btn-icon btn-edit" onclick="editProgram('wadt')" title="Edit Program">‚úèÔ∏è</button>
                            </div>
                        </div>
                        <div class="program-info">
                            <div class="info-item">
                                <div class="info-label">Program Code</div>
                                <div class="info-value">WADT-2024</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Duration</div>
                                <div class="info-value">6 Months</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Available Slots</div>
                                <div class="info-value">45/50</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Passing Score</div>
                                <div class="info-value">75%</div>
                            </div>
                        </div>
                        <div class="program-info">
                            <div class="info-item" style="grid-column: 1 / -1;">
                                <div class="info-label">Description</div>
                                <div class="info-value">Full-stack web development training program covering frontend and backend technologies.</div>
                            </div>
                        </div>
                    </div>

                    <div class="program-card">
                        <div class="program-header">
                            <h3>Hotel & Restaurant Technology (HRT)</h3>
                            <div class="program-actions">
                                <button class="btn-icon btn-edit" onclick="editProgram('hrt')" title="Edit Program">‚úèÔ∏è</button>
                            </div>
                        </div>
                        <div class="program-info">
                            <div class="info-item">
                                <div class="info-label">Program Code</div>
                                <div class="info-value">HRT-2024</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Duration</div>
                                <div class="info-value">6 Months</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Available Slots</div>
                                <div class="info-value">38/50</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Passing Score</div>
                                <div class="info-value">75%</div>
                            </div>
                        </div>
                        <div class="program-info">
                            <div class="info-item" style="grid-column: 1 / -1;">
                                <div class="info-label">Description</div>
                                <div class="info-value">Hospitality management program focusing on hotel and restaurant operations.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reports & Analytics -->
            <div id="reportsSection" class="content-section" style="display: none;">
                <div class="content-header">
                    <h1>Reports & Analytics</h1>
                    <p>Generate and view system reports</p>
                </div>

                <!-- Reports Grid -->
                <div class="reports-grid">
                    <div class="report-card" onclick="generateReport('applicantsPerProgram')">
                        <div class="report-icon">üìä</div>
                        <h4>Applicants Per Program</h4>
                        <p>View total applicants per scholarship program</p>
                    </div>
                    <div class="report-card" onclick="generateReport('applicationStatus')">
                        <div class="report-icon">üìà</div>
                        <h4>Application Status Report</h4>
                        <p>Breakdown of applications by status</p>
                    </div>
                    <div class="report-card" onclick="generateReport('examPerformance')">
                        <div class="report-icon">üíØ</div>
                        <h4>Exam Performance Report</h4>
                        <p>Analyze exam scores and pass rates</p>
                    </div>
                    <div class="report-card" onclick="generateReport('documentStatus')">
                        <div class="report-icon">üìÑ</div>
                        <h4>Document Status Report</h4>
                        <p>Overview of document verification status</p>
                    </div>
                </div>

                <!-- Export Options -->
                <div class="export-buttons">
                    <button class="btn-export" onclick="exportReport('pdf')">
                        <span>üìÑ</span> Export as PDF
                    </button>
                    <button class="btn-export" onclick="exportReport('excel')">
                        <span>üìä</span> Export as Excel
                    </button>
                    <button class="btn-export" onclick="exportReport('csv')">
                        <span>üìã</span> Export as CSV
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Application Details Modal -->
    <div class="modal-overlay" id="applicantModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Application Details</h3>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div id="applicantDetails">
                    <!-- Applicant details will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Document Preview Modal -->
    <div class="modal-overlay" id="documentModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Document Preview</h3>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div id="documentPreview">
                    <!-- Document preview will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== GLOBAL VARIABLES =====
        let allApplicants = [];
        let filteredApplicants = [];
        let adminData = null;
        let currentAdmin = null;

        // ===== INITIALIZATION =====
        window.addEventListener('DOMContentLoaded', function() {
            checkAdminLogin();
            loadAllApplicants();
            updateDashboard();
            setupEventListeners();
        });

        // ===== ADMIN AUTHENTICATION =====
        function checkAdminLogin() {
            // Check multiple possible session storage keys
            const isAdminLoggedIn = sessionStorage.getItem('isAdminLoggedIn');
            const adminUsername = sessionStorage.getItem('adminUsername');
            const userType = sessionStorage.getItem('userType');
            const username = sessionStorage.getItem('username');
            
            console.log('Admin login check - Session storage:', {
                isAdminLoggedIn,
                adminUsername,
                userType,
                username,
                allSession: Object.keys(sessionStorage).map(key => ({ key, value: sessionStorage.getItem(key) }))
            });
        
            // Check if any admin session exists
            let isAdmin = false;
            let adminUser = null;
            
            // Check various admin session indicators
            if (isAdminLoggedIn === 'true') {
                isAdmin = true;
                adminUser = adminUsername || username;
            } else if (userType === 'admin') {
                isAdmin = true;
                adminUser = username;
            } else {
                // Check if there's a username that might be admin
                const possibleAdmins = ['admin', 'administrator', 'superadmin'];
                if (username && possibleAdmins.includes(username.toLowerCase())) {
                    isAdmin = true;
                    adminUser = username;
                }
            }
            
            if (!isAdmin || !adminUser) {
                alert('Please login as administrator to access this dashboard.');
                window.location.href = 'login.html';
                return;
            }
        
            // Load admin data from localStorage
            const admins = JSON.parse(localStorage.getItem('adminUsers') || '[]');
            console.log('Admin users in localStorage:', admins);
            
            // Find admin by username
            currentAdmin = admins.find(admin => admin.username === adminUser);
            
            if (!currentAdmin) {
                console.log('Admin not found in localStorage, checking if default admin...');
                
                // Check if this is the default admin trying to login
                if (adminUser === 'admin') {
                    // Create default admin account
                    const defaultAdmins = [
                        { 
                            username: 'admin', 
                            password: 'admin123', 
                            userType: 'admin',
                            fullName: 'System Administrator',
                            role: 'Super Admin'
                        }
                    ];
                    
                    // Save to localStorage
                    localStorage.setItem('adminUsers', JSON.stringify(defaultAdmins));
                    currentAdmin = defaultAdmins[0];
                    
                    console.log('Default admin created:', currentAdmin);
                } else {
                    alert('Admin account not found in system. Please contact system administrator.');
                    window.location.href = 'login.html';
                    return;
                }
            }
        
            adminData = currentAdmin;
            
            // Update session storage to ensure proper admin flags
            sessionStorage.setItem('isAdminLoggedIn', 'true');
            sessionStorage.setItem('adminUsername', adminData.username);
            sessionStorage.setItem('userType', 'admin');
            sessionStorage.setItem('isLoggedIn', 'true');
            
            // Update admin info in header
            document.getElementById('adminName').textContent = adminData.fullName || 'Administrator';
            document.getElementById('adminRole').textContent = adminData.role || 'System Administrator';
            
            const firstLetter = (adminData.fullName || 'A').charAt(0).toUpperCase();
            document.getElementById('adminAvatar').textContent = firstLetter;
            
            console.log('Admin authenticated successfully:', adminData);
        }

        function loadAdminData() {
            // This function can be expanded to load admin-specific settings
            console.log('Admin data loaded:', adminData);
        }

        function loadAllApplicants() {
            const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            allApplicants = [];
            
            registeredUsers.forEach(user => {
                if (user.applications && user.applications.length > 0) {
                    user.applications.forEach(application => {
                        if (application.status !== 'cancelled') {
                            const applicant = {
                                ...user,
                                application: application,
                                applicationId: application.applicationId,
                                program: application.program,
                                status: application.status,
                                submittedDate: application.submittedDate,
                                documents: application.documents || {},
                                exam: application.exam || { taken: false }
                            };
                            allApplicants.push(applicant);
                        }
                    });
                }
            });
            
            filteredApplicants = [...allApplicants];
            updateNotificationBadges();
            console.log('Loaded applicants:', allApplicants.length);
        }

        function updateDashboard() {
            updateStatistics();
            loadRecentApplications();
        }

        function updateStatistics() {
            // Calculate statistics
            const total = allApplicants.length;
            const pending = allApplicants.filter(app => 
                app.status === 'pending' || app.status === 'under-review' || 
                app.status === 'documents-completed' || app.status === 'exam-completed'
            ).length;
            const approved = allApplicants.filter(app => app.status === 'accepted').length;
            const rejected = allApplicants.filter(app => app.status === 'rejected').length;
            
            // Update UI
            document.getElementById('totalApplications').textContent = total;
            document.getElementById('pendingReview').textContent = pending;
            document.getElementById('approved').textContent = approved;
            document.getElementById('rejected').textContent = rejected;
        }

        function loadRecentApplications() {
            const tbody = document.getElementById('recentApplicationsBody');
            tbody.innerHTML = '';
            
            // Get recent applications (last 10)
            const recentApps = [...allApplicants]
                .sort((a, b) => new Date(b.submittedDate || 0) - new Date(a.submittedDate || 0))
                .slice(0, 10);
            
            if (recentApps.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" class="empty-state">
                            <div class="empty-state-icon">üìù</div>
                            <p>No applications found</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            recentApps.forEach(applicant => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${applicant.applicationId || 'N/A'}</td>
                    <td>${applicant.personal.firstName} ${applicant.personal.lastName}</td>
                    <td>${getProgramName(applicant.program) || 'N/A'}</td>
                    <td>${applicant.submittedDate ? new Date(applicant.submittedDate).toLocaleDateString() : 'N/A'}</td>
                    <td><span class="status-badge badge-${getStatusClass(applicant.status)}">${getStatusText(applicant.status)}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-icon btn-view" onclick="viewApplicant('${applicant.applicationId}')" title="View Details">üëÅÔ∏è</button>
                            <button class="btn-icon btn-approve" onclick="approveApplication('${applicant.applicationId}')" title="Approve">‚úÖ</button>
                            <button class="btn-icon btn-reject" onclick="rejectApplication('${applicant.applicationId}')" title="Reject">‚ùå</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function loadApplicantsTable() {
            const tbody = document.getElementById('applicantsTableBody');
            tbody.innerHTML = '';
            
            if (filteredApplicants.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="9" class="empty-state">
                            <div class="empty-state-icon">üë•</div>
                            <p>No applicants found matching your criteria</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            filteredApplicants.forEach(applicant => {
                // Count uploaded documents
                const uploadedDocs = applicant.documents ? 
                    Object.values(applicant.documents).filter(doc => doc.uploaded).length : 0;
                const totalDocs = 6; // Hardcoded based on your system
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${applicant.applicationId || 'N/A'}</td>
                    <td>${applicant.personal.firstName} ${applicant.personal.lastName}</td>
                    <td>${applicant.personal.email}</td>
                    <td>${getProgramName(applicant.program) || 'N/A'}</td>
                    <td>${applicant.submittedDate ? new Date(applicant.submittedDate).toLocaleDateString() : 'N/A'}</td>
                    <td>${uploadedDocs}/${totalDocs}</td>
                    <td>${applicant.exam.taken ? `${applicant.exam.score}%` : 'Not Taken'}</td>
                    <td><span class="status-badge badge-${getStatusClass(applicant.status)}">${getStatusText(applicant.status)}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-icon btn-view" onclick="viewApplicant('${applicant.applicationId}')" title="View Details">üëÅÔ∏è</button>
                            <button class="btn-icon btn-approve" onclick="approveApplication('${applicant.applicationId}')" ${applicant.status === 'accepted' ? 'disabled' : ''} title="Approve">‚úÖ</button>
                            <button class="btn-icon btn-reject" onclick="rejectApplication('${applicant.applicationId}')" ${applicant.status === 'rejected' ? 'disabled' : ''} title="Reject">‚ùå</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function loadDocumentsTable() {
            const tbody = document.getElementById('documentsTableBody');
            tbody.innerHTML = '';
            
            // Collect all documents from all applicants
            let allDocuments = [];
            
            filteredApplicants.forEach(applicant => {
                if (applicant.documents) {
                    Object.entries(applicant.documents).forEach(([docType, docData]) => {
                        if (docData.uploaded) {
                            allDocuments.push({
                                studentName: `${applicant.personal.firstName} ${applicant.personal.lastName}`,
                                docType: docData.type || docType,
                                fileName: docData.filename,
                                uploadDate: docData.lastModified || applicant.submittedDate,
                                status: docData.verified ? 'verified' : 'pending',
                                applicantId: applicant.applicationId,
                                docId: docType
                            });
                        }
                    });
                }
            });
            
            if (allDocuments.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" class="empty-state">
                            <div class="empty-state-icon">üìÑ</div>
                            <p>No documents uploaded yet</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            allDocuments.forEach(doc => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${doc.studentName}</td>
                    <td>${doc.docType}</td>
                    <td>${doc.fileName}</td>
                    <td>${doc.uploadDate ? new Date(doc.uploadDate).toLocaleDateString() : 'N/A'}</td>
                    <td><span class="status-badge ${doc.status === 'verified' ? 'badge-approved' : 'badge-pending'}">${doc.status === 'verified' ? 'Verified' : 'Pending'}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-icon btn-view" onclick="viewDocument('${doc.applicantId}', '${doc.docId}')" title="View Document">üëÅÔ∏è</button>
                            <button class="btn-icon btn-approve" onclick="verifyDocument('${doc.applicantId}', '${doc.docId}')" ${doc.status === 'verified' ? 'disabled' : ''} title="Verify">‚úÖ</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function loadExamResults() {
            const tbody = document.getElementById('examResultsBody');
            tbody.innerHTML = '';
            
            // Filter applicants who have taken exam
            const examTakers = filteredApplicants.filter(app => app.exam && app.exam.taken);
            
            if (examTakers.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" class="empty-state">
                            <div class="empty-state-icon">üíØ</div>
                            <p>No exam results available</p>
                        </td>
                    </tr>
                `;
                updateExamStats(0, 0, 0, 0);
                return;
            }
            
            // Calculate exam statistics
            const totalExams = examTakers.length;
            const passedExams = examTakers.filter(app => app.exam.passed).length;
            const passRate = Math.round((passedExams / totalExams) * 100);
            const avgScore = Math.round(examTakers.reduce((sum, app) => sum + app.exam.score, 0) / totalExams);
            const topScore = Math.max(...examTakers.map(app => app.exam.score));
            
            updateExamStats(totalExams, passRate, avgScore, topScore);
            
            // Populate table
            examTakers.forEach(applicant => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${applicant.personal.firstName} ${applicant.personal.lastName}</td>
                    <td>${getProgramName(applicant.program) || 'N/A'}</td>
                    <td>${applicant.exam.score}%</td>
                    <td><span class="status-badge ${applicant.exam.passed ? 'badge-approved' : 'badge-rejected'}">${applicant.exam.passed ? 'Passed' : 'Failed'}</span></td>
                    <td>${applicant.exam.dateTaken ? new Date(applicant.exam.dateTaken).toLocaleDateString() : 'N/A'}</td>
                    <td>
                        <button class="btn-icon btn-view" onclick="viewExamDetails('${applicant.applicationId}')" title="View Details">üëÅÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateExamStats(total, passRate, avgScore, topScore) {
            document.getElementById('totalExams').textContent = total;
            document.getElementById('passRate').textContent = `${passRate}%`;
            document.getElementById('avgScore').textContent = `${avgScore}%`;
            document.getElementById('topScore').textContent = `${topScore}%`;
        }

        // ===== FILTER FUNCTIONS =====
        function filterApplicants() {
            const programFilter = document.getElementById('filterProgram').value;
            const statusFilter = document.getElementById('filterStatus').value;
            const dateFrom = document.getElementById('filterDateFrom').value;
            const dateTo = document.getElementById('filterDateTo').value;
            const searchQuery = document.getElementById('applicantSearch').value.toLowerCase();
            
            filteredApplicants = allApplicants.filter(applicant => {
                // Program filter
                if (programFilter && applicant.program !== programFilter) return false;
                
                // Status filter
                if (statusFilter) {
                    if (statusFilter === 'pending' && !['pending', 'under-review', 'documents-completed', 'exam-completed'].includes(applicant.status)) return false;
                    if (statusFilter === 'approved' && applicant.status !== 'accepted') return false;
                    if (statusFilter === 'rejected' && applicant.status !== 'rejected') return false;
                    if (statusFilter === 'under-review' && applicant.status !== 'under-review') return false;
                }
                
                // Date range filter
                if (dateFrom && applicant.submittedDate) {
                    const submittedDate = new Date(applicant.submittedDate);
                    const fromDate = new Date(dateFrom);
                    if (submittedDate < fromDate) return false;
                }
                
                if (dateTo && applicant.submittedDate) {
                    const submittedDate = new Date(applicant.submittedDate);
                    const toDate = new Date(dateTo);
                    if (submittedDate > toDate) return false;
                }
                
                // Search filter
                if (searchQuery) {
                    const fullName = `${applicant.personal.firstName} ${applicant.personal.lastName}`.toLowerCase();
                    const email = applicant.personal.email.toLowerCase();
                    const appId = (applicant.applicationId || '').toLowerCase();
                    
                    if (!fullName.includes(searchQuery) && !email.includes(searchQuery) && !appId.includes(searchQuery)) {
                        return false;
                    }
                }
                
                return true;
            });
            
            // Reload tables based on current section
            const currentSection = document.querySelector('.content-section[style="display: block;"]').id;
            
            switch(currentSection) {
                case 'applicantsSection':
                    loadApplicantsTable();
                    break;
                case 'documentsSection':
                    loadDocumentsTable();
                    break;
                case 'examSection':
                    loadExamResults();
                    break;
            }
        }

        // ===== APPLICATION MANAGEMENT =====
        function viewApplicant(applicationId) {
            const applicant = allApplicants.find(app => app.applicationId === applicationId);
            if (!applicant) {
                alert('Applicant not found!');
                return;
            }
            
            const modalContent = document.getElementById('applicantDetails');
            modalContent.innerHTML = `
                <div class="applicant-details">
                    <div class="detail-section">
                        <h4>Personal Information</h4>
                        <div class="detail-row">
                            <div class="detail-label">Full Name:</div>
                            <div class="detail-value">${applicant.personal.firstName} ${applicant.personal.lastName}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Email:</div>
                            <div class="detail-value">${applicant.personal.email}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Phone:</div>
                            <div class="detail-value">${applicant.personal.phone || 'N/A'}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Address:</div>
                            <div class="detail-value">${applicant.personal.address || 'N/A'}</div>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h4>Application Details</h4>
                        <div class="detail-row">
                            <div class="detail-label">Application ID:</div>
                            <div class="detail-value">${applicant.applicationId}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Program:</div>
                            <div class="detail-value">${getProgramName(applicant.program) || 'N/A'}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Status:</div>
                            <div class="detail-value">
                                <span class="status-badge badge-${getStatusClass(applicant.status)}">
                                    ${getStatusText(applicant.status)}
                                </span>
                            </div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Date Applied:</div>
                            <div class="detail-value">${applicant.submittedDate ? new Date(applicant.submittedDate).toLocaleDateString() : 'N/A'}</div>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h4>Documents Status</h4>
                        <div class="documents-grid">
                            ${Object.entries(applicant.documents || {}).map(([key, doc]) => `
                                <div class="document-item ${doc.verified ? 'verified' : doc.uploaded ? '' : 'required'}">
                                    <div class="document-header">
                                        <div class="document-name">${doc.type || key}</div>
                                        <div class="document-actions">
                                            <span class="status-badge ${doc.verified ? 'badge-approved' : doc.uploaded ? 'badge-pending' : 'badge-rejected'}">
                                                ${doc.verified ? 'Verified' : doc.uploaded ? 'Pending' : 'Missing'}
                                            </span>
                                        </div>
                                    </div>
                                    ${doc.uploaded ? `<p style="margin-top: 10px; font-size: 12px;">File: ${doc.filename}</p>` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    ${applicant.exam.taken ? `
                    <div class="detail-section">
                        <h4>Exam Results</h4>
                        <div class="exam-results">
                            <div class="exam-score">${applicant.exam.score}%</div>
                            <div class="exam-details">
                                <div class="detail-row">
                                    <div class="detail-label">Result:</div>
                                    <div class="detail-value">
                                        <span class="status-badge ${applicant.exam.passed ? 'badge-approved' : 'badge-rejected'}">
                                            ${applicant.exam.passed ? 'Passed' : 'Failed'}
                                        </span>
                                    </div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-label">Date Taken:</div>
                                    <div class="detail-value">${new Date(applicant.exam.dateTaken).toLocaleDateString()}</div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-label">Passing Score:</div>
                                    <div class="detail-value">${applicant.exam.passingScore || 75}%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    ` : ''}
                </div>
                
                <div style="margin-top: 30px; display: flex; gap: 15px; justify-content: center;">
                    ${applicant.status !== 'accepted' ? `
                    <button class="btn-filter" onclick="approveApplication('${applicant.applicationId}', true)" style="background: var(--success);">
                        Approve Application
                    </button>
                    ` : ''}
                    
                    ${applicant.status !== 'rejected' ? `
                    <button class="btn-filter" onclick="rejectApplication('${applicant.applicationId}', true)" style="background: var(--danger);">
                        Reject Application
                    </button>
                    ` : ''}
                    
                    <button class="btn-filter" onclick="closeModal()">
                        Close
                    </button>
                </div>
            `;
            
            document.getElementById('applicantModal').style.display = 'flex';
        }

        function approveApplication(applicationId, fromModal = false) {
            if (!confirm('Are you sure you want to approve this application?')) return;
            
            // Update application status in localStorage
            const users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            let updated = false;
            
            users.forEach(user => {
                if (user.applications) {
                    user.applications.forEach(app => {
                        if (app.applicationId === applicationId) {
                            app.status = 'accepted';
                            app.adminReview = {
                                reviewDate: new Date().toISOString(),
                                reviewer: adminData.fullName || 'Admin',
                                decision: 'accepted',
                                notes: 'Application approved by administrator'
                            };
                            
                            // Add to timeline
                            if (!app.timeline) app.timeline = [];
                            app.timeline.push({
                                date: new Date().toISOString(),
                                event: 'Application approved by administrator'
                            });
                            
                            updated = true;
                        }
                    });
                }
            });
            
            if (updated) {
                localStorage.setItem('registeredUsers', JSON.stringify(users));
                
                // Refresh data
                loadAllApplicants();
                updateDashboard();
                
                if (fromModal) {
                    closeModal();
                    setTimeout(() => {
                        viewApplicant(applicationId);
                    }, 100);
                } else {
                    loadApplicantsTable();
                }
                
                alert('Application approved successfully!');
            } else {
                alert('Error: Application not found!');
            }
        }

        function rejectApplication(applicationId, fromModal = false) {
            const reason = prompt('Please enter the reason for rejection:');
            if (!reason) return;
            
            // Update application status in localStorage
            const users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            let updated = false;
            
            users.forEach(user => {
                if (user.applications) {
                    user.applications.forEach(app => {
                        if (app.applicationId === applicationId) {
                            app.status = 'rejected';
                            app.adminReview = {
                                reviewDate: new Date().toISOString(),
                                reviewer: adminData.fullName || 'Admin',
                                decision: 'rejected',
                                notes: reason
                            };
                            
                            // Add to timeline
                            if (!app.timeline) app.timeline = [];
                            app.timeline.push({
                                date: new Date().toISOString(),
                                event: 'Application rejected by administrator'
                            });
                            
                            updated = true;
                        }
                    });
                }
            });
            
            if (updated) {
                localStorage.setItem('registeredUsers', JSON.stringify(users));
                
                // Refresh data
                loadAllApplicants();
                updateDashboard();
                
                if (fromModal) {
                    closeModal();
                } else {
                    loadApplicantsTable();
                }
                
                alert('Application rejected successfully!');
            } else {
                alert('Error: Application not found!');
            }
        }

        // ===== DOCUMENT MANAGEMENT =====
        function verifyDocument(applicationId, documentId) {
            const users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            let updated = false;
            
            users.forEach(user => {
                if (user.applications) {
                    user.applications.forEach(app => {
                        if (app.applicationId === applicationId && app.documents && app.documents[documentId]) {
                            app.documents[documentId].verified = true;
                            updated = true;
                        }
                    });
                }
            });
            
            if (updated) {
                localStorage.setItem('registeredUsers', JSON.stringify(users));
                loadAllApplicants();
                loadDocumentsTable();
                alert('Document verified successfully!');
            }
        }

        // ===== PROGRAM MANAGEMENT =====
        function editProgram(programId) {
            const programName = getProgramName(programId);
            const newSlots = prompt(`Enter new available slots for ${programName}:`, "50");
            
            if (newSlots && !isNaN(newSlots)) {
                alert(`Updated ${programName} slots to ${newSlots}`);
                // In a real implementation, you would update this in localStorage
            }
        }

        // ===== SECTION MANAGEMENT =====
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });

            // Remove active class from all nav links
            document.querySelectorAll('.sidebar-nav a').forEach(link => {
                link.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionId + 'Section').style.display = 'block';
            
            // Add active class to clicked nav link
            document.querySelector(`[onclick="showSection('${sectionId}')"]`).classList.add('active');

            // Load section-specific content
            switch(sectionId) {
                case 'applicants':
                    loadApplicantsTable();
                    break;
                case 'documents':
                    loadDocumentsTable();
                    break;
                case 'exam':
                    loadExamResults();
                    break;
            }
        }

        // ===== UTILITY FUNCTIONS =====
        function getProgramName(programCode) {
            const programs = {
                'wadt': 'Web Application Development Training (WADT)',
                'hrt': 'Hotel & Restaurant Technology (HRT)'
            };
            return programs[programCode] || programCode;
        }

        function getStatusText(status) {
            const statusMap = {
                'not-started': 'Not Started',
                'applied': 'Applied',
                'documents-completed': 'Documents Completed',
                'exam-completed': 'Exam Completed',
                'pending': 'Pending Review',
                'under-review': 'Under Review',
                'accepted': 'Approved',
                'rejected': 'Rejected'
            };
            return statusMap[status] || status;
        }

        function getStatusClass(status) {
            const classMap = {
                'not-started': 'pending',
                'applied': 'pending',
                'documents-completed': 'pending',
                'exam-completed': 'pending',
                'pending': 'pending',
                'under-review': 'under-review',
                'accepted': 'approved',
                'rejected': 'rejected'
            };
            return classMap[status] || 'pending';
        }

        function updateNotificationBadges() {
            // Count pending applications
            const pendingApps = allApplicants.filter(app => 
                app.status === 'pending' || app.status === 'under-review' || 
                app.status === 'documents-completed' || app.status === 'exam-completed'
            ).length;
            
            // Count unverified documents
            let unverifiedDocs = 0;
            allApplicants.forEach(applicant => {
                if (applicant.documents) {
                    Object.values(applicant.documents).forEach(doc => {
                        if (doc.uploaded && !doc.verified) {
                            unverifiedDocs++;
                        }
                    });
                }
            });
            
            document.getElementById('applicantsNotification').textContent = pendingApps;
            document.getElementById('documentsNotification').textContent = unverifiedDocs;
        }

        function closeModal() {
            document.getElementById('applicantModal').style.display = 'none';
            document.getElementById('documentModal').style.display = 'none';
        }

        function logout() {
            sessionStorage.clear();
            window.location.href = 'login.html';
        }

        function setupEventListeners() {
            // Global search
            document.getElementById('globalSearch').addEventListener('input', function(e) {
                const query = e.target.value.toLowerCase();
                if (query.length >= 2) {
                    showSection('applicants');
                    document.getElementById('applicantSearch').value = query;
                    filterApplicants();
                }
            });
            
            // Applicant search
            document.getElementById('applicantSearch').addEventListener('input', filterApplicants);
            
            // Filter controls
            document.getElementById('filterProgram').addEventListener('change', filterApplicants);
            document.getElementById('filterStatus').addEventListener('change', filterApplicants);
            document.getElementById('filterDateFrom').addEventListener('change', filterApplicants);
            document.getElementById('filterDateTo').addEventListener('change', filterApplicants);
        }

        // ===== REPORTS FUNCTIONS =====
        function generateReport(reportType) {
            let reportData = {};
            let reportTitle = '';
            
            switch(reportType) {
                case 'applicantsPerProgram':
                    reportTitle = 'Applicants Per Program Report';
                    const programCounts = {};
                    allApplicants.forEach(app => {
                        const program = getProgramName(app.program) || 'Unknown';
                        programCounts[program] = (programCounts[program] || 0) + 1;
                    });
                    reportData = programCounts;
                    break;
                    
                case 'applicationStatus':
                    reportTitle = 'Application Status Report';
                    const statusCounts = {};
                    allApplicants.forEach(app => {
                        const status = getStatusText(app.status);
                        statusCounts[status] = (statusCounts[status] || 0) + 1;
                    });
                    reportData = statusCounts;
                    break;
                    
                case 'examPerformance':
                    reportTitle = 'Exam Performance Report';
                    const examTakers = allApplicants.filter(app => app.exam && app.exam.taken);
                    const passed = examTakers.filter(app => app.exam.passed).length;
                    const failed = examTakers.length - passed;
                    const avgScore = examTakers.length > 0 ? 
                        Math.round(examTakers.reduce((sum, app) => sum + app.exam.score, 0) / examTakers.length) : 0;
                    
                    reportData = {
                        'Total Exams Taken': examTakers.length,
                        'Passed': passed,
                        'Failed': failed,
                        'Pass Rate': `${Math.round((passed / examTakers.length) * 100) || 0}%`,
                        'Average Score': `${avgScore}%`
                    };
                    break;
                    
                case 'documentStatus':
                    reportTitle = 'Document Status Report';
                    let uploaded = 0, verified = 0, missing = 0;
                    
                    allApplicants.forEach(applicant => {
                        if (applicant.documents) {
                            Object.values(applicant.documents).forEach(doc => {
                                if (doc.uploaded) {
                                    uploaded++;
                                    if (doc.verified) verified++;
                                } else {
                                    missing++;
                                }
                            });
                        }
                    });
                    
                    reportData = {
                        'Total Documents': uploaded + missing,
                        'Uploaded': uploaded,
                        'Verified': verified,
                        'Pending Verification': uploaded - verified,
                        'Missing': missing
                    };
                    break;
            }
            
            // Display report in modal
            const modalContent = document.getElementById('applicantDetails');
            modalContent.innerHTML = `
                <h3 style="color: var(--primary-blue); margin-bottom: 20px;">${reportTitle}</h3>
                <p style="color: var(--medium-gray); margin-bottom: 30px;">Generated on ${new Date().toLocaleDateString()}</p>
                
                <div style="background: var(--light-blue); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    ${Object.entries(reportData).map(([key, value]) => `
                        <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.5);">
                            <span style="font-weight: 600; color: var(--dark-gray);">${key}:</span>
                            <span style="color: var(--primary-blue); font-weight: bold;">${value}</span>
                        </div>
                    `).join('')}
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn-filter" onclick="exportReportData('${reportType}')" style="background: var(--success);">
                        Export Report
                    </button>
                    <button class="btn-filter" onclick="closeModal()">
                        Close
                    </button>
                </div>
            `;
            
            document.getElementById('applicantModal').style.display = 'flex';
        }

        function exportReport(format) {
            alert(`${format.toUpperCase()} export feature would be implemented here.`);
            // Implementation would require additional libraries like jsPDF or SheetJS
        }

        function exportReportData(reportType) {
            // Simple export to JSON
            const data = { reportType, data: getReportData(reportType), generated: new Date().toISOString() };
            const dataStr = JSON.stringify(data, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `${reportType}_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        function getReportData(reportType) {
            // Return the data for the report
            switch(reportType) {
                case 'applicantsPerProgram':
                    const programCounts = {};
                    allApplicants.forEach(app => {
                        const program = getProgramName(app.program) || 'Unknown';
                        programCounts[program] = (programCounts[program] || 0) + 1;
                    });
                    return programCounts;
                    
                case 'applicationStatus':
                    const statusCounts = {};
                    allApplicants.forEach(app => {
                        const status = getStatusText(app.status);
                        statusCounts[status] = (statusCounts[status] || 0) + 1;
                    });
                    return statusCounts;
            }
            return {};
        }

        // ===== DEBUG FUNCTIONS =====
        window.debugAdmin = function() {
            console.log('=== ADMIN DEBUG INFO ===');
            console.log('Current admin:', adminData);
            console.log('All applicants:', allApplicants);
            console.log('Filtered applicants:', filteredApplicants);
            console.log('Session storage:', {
                isAdminLoggedIn: sessionStorage.getItem('isAdminLoggedIn'),
                adminUsername: sessionStorage.getItem('adminUsername'),
                userType: sessionStorage.getItem('userType')
            });
        };

        window.createTestStudent = function() {
            const testAccount = {
                personal: {
                    firstName: "Test",
                    lastName: "Student",
                    email: "test@student.com",
                    phone: "09123456789",
                    birthdate: "2000-01-01",
                    address: "Test Address",
                    gender: "male"
                },
                account: {
                    username: "teststudent",
                    password: "test1234",
                    securityQuestion: "What is your favorite color?",
                    securityAnswer: "blue"
                },
                applications: [{
                    applicationId: 'TEST-' + Date.now(),
                    program: 'wadt',
                    status: 'pending',
                    submittedDate: new Date().toISOString(),
                    documents: {
                        picture: { uploaded: true, filename: 'id_picture.jpg', verified: false, type: '2x2 ID Picture' },
                        birthcert: { uploaded: true, filename: 'birth_cert.pdf', verified: true, type: 'Birth Certificate' },
                        reportcard: { uploaded: true, filename: 'report_card.pdf', verified: false, type: 'Report Card' },
                        goodmoral: { uploaded: false, filename: null, verified: false, type: 'Certificate of Good Moral Character' },
                        tor: { uploaded: false, filename: null, verified: false, type: 'Transcript of Records (TOR)' },
                        diploma: { uploaded: false, filename: null, verified: false, type: 'High School Diploma' }
                    },
                    exam: { taken: true, score: 85, passed: true, dateTaken: new Date().toISOString() }
                }],
                registrationDate: new Date().toISOString()
            };
            
            const existingUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            existingUsers.push(testAccount);
            localStorage.setItem('registeredUsers', JSON.stringify(existingUsers));
            
            loadAllApplicants();
            updateDashboard();
            alert('‚úÖ Test student created with application!');
        };
    </script>
</body>
</html>